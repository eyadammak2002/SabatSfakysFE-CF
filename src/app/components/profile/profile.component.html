
<!-- profile.component.html -->
<div class="profile-container">
  <div *ngIf="loading && !client" class="loading-spinner">
      <div class="spinner-border text-primary" role="status">
        <span class="sr-only">Chargement...</span>
      </div>
      <p class="loading-text">Chargement de votre profil...</p>
  </div>
  
  <div *ngIf="errorMessage" class="alert alert-danger">
    {{ errorMessage }}
  </div>
  
  <div *ngIf="successMessage" class="alert alert-success">
    {{ successMessage }}
  </div>
  
  <!-- Mode affichage -->
  <div *ngIf="!isEditing && client" class="profile-card">
      <div class="profile-header">
          <h2 class="profile-title">{{ client.nom || 'Profil utilisateur' }}</h2>
          <p class="profile-subtitle">Informations personnelles</p>
      </div>
      
      <div class="profile-view">
          <div class="profile-info">
              <div class="info-group">
                  <div class="info-icon">
                      <i class="fas fa-envelope"></i>
                  </div>
                  <div class="info-content">
                      <div class="info-label">Email</div>
                      <div class="info-value">{{ client.email }}</div>
                  </div>
              </div>
              
              <div class="info-group">
                  <div class="info-icon">
                      <i class="fas fa-map-marker-alt"></i>
                  </div>
                  <div class="info-content">
                      <div class="info-label">Adresse</div>
                      <div class="info-value">{{ client.adresse || 'Non spécifiée' }}</div>
                  </div>
              </div>
              
              <div class="info-group">
                  <div class="info-icon">
                      <i class="fas fa-phone"></i>
                  </div>
                  <div class="info-content">
                      <div class="info-label">Téléphone</div>
                      <div class="info-value">{{ client.telephone || 'Non spécifié' }}</div>
                  </div>
              </div>
              
              <div class="info-group">
                  <div class="info-icon">
                      <i class="fas fa-user"></i>
                  </div>
                  <div class="info-content">
                      <div class="info-label">Genre</div>
                      <div class="info-value">{{ client.sexe === 'Homme' ? 'Homme' : (client.sexe === 'Femme' ? 'Femme' : 'Non spécifié') }}</div>
                  </div>
              </div>
          </div>
          
          <div class="edit-button-container">
             <button (click)="toggleEdit()" class="brown-button cancel">
                  <span class="btn-icon"><i class="fas fa-edit"></i></span>
                  <span class="btn-text">Modifier</span>
              </button>
                 <!-- Ajouter ce bouton de suppression -->
                <button (click)="toggleDeleteConfirmation()" class="brown-button delete">
                    <span class="btn-icon"><i class="fas fa-trash"></i></span>
                    <span class="btn-text">Supprimer mon compte</span>
                </button>
            
          </div>
      </div>
  </div>
  
  <!-- Mode édition -->
  <div *ngIf="isEditing && client" class="profile-card">
      <div class="profile-header">
          <h2 class="profile-title">Éditer le profil</h2>
          <p class="profile-subtitle">Modifier vos informations</p>
      </div>
      
      <div class="profile-edit">
          <form [formGroup]="profileForm" (ngSubmit)="onSubmit()">
              <div class="form-group">
                  <label for="nom">Nom</label>
                  <input 
                      type="text" 
                      id="nom" 
                      formControlName="nom" 
                      class="form-control"
                      [ngClass]="{'is-invalid': profileForm?.get('nom')?.invalid && profileForm?.get('nom')?.touched}" 
                  />
                  <div *ngIf="profileForm?.get('nom')?.invalid && profileForm?.get('nom')?.touched" class="invalid-feedback">
                      Le nom est requis
                  </div>
              </div>
              
              <div class="form-group">
                  <label for="email">Email</label>
                  <input 
                      type="email" 
                      id="email" 
                      formControlName="email" 
                      class="form-control"
                      [ngClass]="{'is-invalid': profileForm?.get('email')?.invalid && profileForm?.get('email')?.touched}" 
                  />
                  <div *ngIf="profileForm?.get('email')?.invalid && profileForm?.get('email')?.touched" class="invalid-feedback">
                      Email invalide
                  </div>
              </div>
              
              <div class="form-group">
                  <label for="adresse">Adresse</label>
                  <input 
                      type="text" 
                      id="adresse" 
                      formControlName="adresse" 
                      class="form-control" 
                  />
              </div>
              
              <div class="form-group">
                  <label for="telephone">Téléphone</label>
                  <input 
                      type="tel" 
                      id="telephone" 
                      formControlName="telephone" 
                      class="form-control" 
                  />
              </div>
              
              <div class="form-group">
                  <label for="sexe">Genre</label>
                  <select 
                      id="sexe" 
                      formControlName="sexe" 
                      class="form-control"
                  >
                      <option value="HOMME">Homme</option>
                      <option value="FEMME">Femme</option>
                  </select>
              </div>
              
              <div class="buttons-container">
                  <button type="submit" class="brown-button" [disabled]="profileForm.invalid || loading">
                      <span class="btn-icon"><i class="fas fa-save"></i></span>
                      <span class="btn-text">Enregistrer</span>
                  </button>
                  <button type="button" class="brown-button cancel" (click)="toggleEdit()">
                      <span class="btn-icon"><i class="fas fa-times"></i></span>
                      <span class="btn-text">Annuler</span>
                  </button>
              </div>
          </form>
      </div>
  </div>
</div>
<!-- Ajouter cette boîte de dialogue de confirmation à la fin de la div profile-container -->
<div *ngIf="showDeleteConfirmation" class="delete-confirmation-overlay">
    <div class="delete-confirmation-modal">
      <h3 class="confirmation-title">Supprimer votre compte</h3>
      <p class="confirmation-message">Cette action est définitive. Toutes vos données seront supprimées.</p>
      <p class="confirmation-warning">Pour confirmer, veuillez entrer votre mot de passe:</p>
      
      <div class="form-group">
        <input 
          type="password" 
          [(ngModel)]="deletePassword" 
          class="form-control" 
          placeholder="Votre mot de passe" 
        />
      </div>
      
      <div class="buttons-container">
        <button 
          (click)="confirmDeleteAccount()" 
          class="brown-button delete" 
          [disabled]="loading || !deletePassword">
          <span class="btn-icon"><i class="fas fa-trash"></i></span>
          <span class="btn-text">Confirmer la suppression</span>
        </button>
        <button 
          (click)="toggleDeleteConfirmation()" 
          class="brown-button cancel">
          <span class="btn-icon"><i class="fas fa-times"></i></span>
          <span class="btn-text">Annuler</span>
        </button>
      </div>
    </div>
  </div>